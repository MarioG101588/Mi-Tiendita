<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Permissions-Policy" content="unload=(), camera=(), microphone=(), geolocation=()">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https: data: blob:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; style-src 'self' 'unsafe-inline' https:;">
    <title>Sistema POS - El Arrendajo Azul</title>
    
    <!-- Script de supresión de errores jQuery/Firebase -->
    <script>
        (function() {
            const originalWarn = console.warn;
            const originalInfo = console.info;
            
            console.warn = function(...args) {
                const mensaje = args.join(' ');
                if (mensaje.includes('Permissions policy violation') || 
                    mensaje.includes('unload is not allowed') ||
                    mensaje.includes('jquery.js:1040')) {
                    return; // Suprimir warnings de unload
                }
                originalWarn.apply(console, args);
            };
            
            console.info = function(...args) {
                const mensaje = args.join(' ');
                if (mensaje.includes('The current domain is not authorized for OAuth') ||
                    mensaje.includes('Add your domain (127.0.0.1)') ||
                    mensaje.includes('iframe.js:310')) {
                    return; // Suprimir info de Firebase OAuth para localhost
                }
                originalInfo.apply(console, args);
            };
        })();
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link rel="stylesheet" href="./Css/estilo.css">
    
</head>
<body>
    <!-- Template para modal de medios de pago -->
    <template id="modalMediosPagoTemplate">
        <div class="modal-pago-container">
            <button type="button" class="pago-btn pago-efectivo" onclick="window.seleccionarMedioPagoModal('Efectivo')">
                <span class="pago-emoji">💵</span>
                <span>Efectivo</span>
            </button>
            <button type="button" class="pago-btn pago-nequi" onclick="window.seleccionarMedioPagoModal('Nequi')">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Nequi_logo.svg/1200px-Nequi_logo.svg.png" 
                     alt="Nequi" class="icono-pago nequi-logo">
                <span>Nequi</span>
            </button>
            <button type="button" class="pago-btn pago-daviplata" onclick="window.seleccionarMedioPagoModal('Daviplata')">
                <img src="https://play-lh.googleusercontent.com/EMobDJKabP1eVoxKVuHBGZsO-YMCvSDyyAWGnwh12LqHHPgjRdcOh7rpzrM6-T5Gf8E=w240-h480-rw" 
                     alt="DaviPlata" class="icono-pago">
                <span>DaviPlata</span>
            </button>
        </div>
    </template>

    <div class="containerPendientes d-none" id="containerPendientes">
    <h1 class="titulo-superior">📋 Cuentas Pendientes Por Cobrar</h1>
    <div id="cuentasPendientesTurno" class="mt-1 mb-2"></div>
    <div class="d-flex flex-wrap gap-2 mt-3">
        <button onclick="mostrarContainer('container2')" class="btn btn-primary flex-fill">
            ↩️ Ir a Cuentas Activas
        </button>
        <button onclick="mostrarContainer('container2'); setTimeout(() => window.mostrarCuentasPendientes(), 500);" class="btn btn-outline-secondary flex-fill">
            🔄 Actualizar Lista
        </button>
    </div>
</div>

    <div class="container container-login container-visible" id="container">
    <h1>Inicio de Sesión</h1>
    <button id="loginButton" class="btn-login">Iniciar de sesión</button>
    <div id="loginForm" class="d-none">
        <div class="form-floating mb-3">
            <input type="email" class="form-control" id="emailinicio" placeholder="name@example.com">
            <label for="emailinicio">Email address</label>
        </div>
        <div class="form-floating mb-3">
            <input type="password" class="form-control" id="passwordinicio" placeholder="Password">
            <label for="passwordinicio">Password</label>
        </div>
        <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" id="recordarDatos">
        <label class="form-check-label" for="recordarDatos">Recordar datos</label>
    </div>
        <div class="d-flex flex-wrap gap-2">
            <button id="btnIniciarSesion" class="btn btn-primary flex-fill">Siguiente</button>
            <button id="closeButton" class="btn btn-secondary flex-fill">Cerrar</button>
        </div>
    </div>
</div>
    </div>
<div class="container1 d-none" id="container1">
    <h1 class="titulo-superior">Ventas</h1>
    <div class="buscador-container">
        <input type="text" id="campoBusqueda1" class="form-control" placeholder="Buscar productos...">
    </div>
    <div id="resultadoBusqueda1" class="resultado-busqueda d-none"></div>
    <div id="carritoVenta"></div>
    <div class="d-flex justify-content-center">
        <button onclick="mostrarContainer('container2')" class="btn btn-primary">
            📋 Ir a Cuentas En Turno
        </button>
    </div>
</div>
</div>
<div class="container2 d-none" id="container2">
    <h1 class="titulo-superior">🐦 El Arrendajo Azul</h1>
    <h2 class="titulo-superior">Cuentas En Turno</h2>
    <div id="cuentasActivasTurno" class="mt-1 mb-2"></div>
    <div class="d-flex flex-wrap gap-2">
        <button onclick="mostrarContainer('container1')" class="btn btn-success flex-fill">
            🛒 Nueva Venta
        </button>
        <button onclick="mostrarContainer('containerResumenTurno')" class="btn btn-info flex-fill">
            📊 Ver Resumen del Turno
        </button>
    </div>
</div>
</div>

<div class="containerResumenTurno d-none" id="containerResumenTurno">
    <h1 class="titulo-superior">📊 Resumen del Turno</h1>
    <div id="resumenTurnoContent" class="mt-3 mb-3"></div>
    <div class="d-flex flex-wrap gap-2">
        <button onclick="mostrarContainer('container2')" class="btn btn-primary flex-fill">
            ↩️ Volver a Cuentas En Turno
        </button>
        <button onclick="cerrarSesion()" class="btn btn-danger flex-fill">
            🚪 Cerrar sesión
        </button>
    </div>
</div>
<div class="container3 d-none" id="container3">
    <div id="detalleCuentaContainer"></div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script type="module" src="JavaScript/Engranaje.js"></script>
    <script type="module" src="JavaScript/Cuentas.js"></script>
</body>
</html>